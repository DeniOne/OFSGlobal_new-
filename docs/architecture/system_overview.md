# Обзор архитектуры системы OFS Global

## Введение

OFS Global — система управления организационной структурой предприятия с поддержкой матричной модели управления. Система позволяет визуализировать и управлять как традиционной иерархической структурой, так и функциональными (кросс-организационными) связями между сотрудниками.

## Архитектура системы

Система построена по принципу трехуровневой архитектуры:

1. **Уровень представления** (Frontend)
2. **Уровень бизнес-логики** (Backend API)
3. **Уровень хранения данных** (Database)

![Архитектура системы](../assets/architecture_diagram.png)

### Технологический стек

#### Backend:
- **Язык программирования**: Python 3.9+
- **Web-фреймворк**: FastAPI
- **ORM**: SQLAlchemy
- **Миграции**: Alembic
- **Валидация данных**: Pydantic
- **Аутентификация**: JWT

#### Frontend:
- **Язык программирования**: TypeScript
- **UI-фреймворк**: React
- **Управление состоянием**: React Context
- **Компонентная библиотека**: Material-UI
- **Визуализация**: ReactFlow
- **Сборка**: Vite

#### База данных:
- **СУБД**: PostgreSQL
- **Дополнительное хранилище**: Redis (для кеширования)

### Основные компоненты системы

#### Backend компоненты:

1. **API Layer (api/)** - REST API эндпоинты для взаимодействия с фронтендом
2. **Models (models/)** - Модели данных ORM
3. **Schemas (schemas/)** - Схемы валидации (Pydantic)
4. **CRUD (crud/)** - Операции работы с данными
5. **Core (core/)** - Настройки, константы, безопасность
6. **Services (services/)** - Бизнес-логика
7. **Utils (utils/)** - Вспомогательные функции

#### Frontend компоненты:

1. **Pages (pages/)** - Страницы приложения
2. **Components (components/)** - React-компоненты
3. **API (api/)** - API-клиенты для взаимодействия с бэкендом
4. **Context (context/)** - Управление глобальным состоянием
5. **Hooks (hooks/)** - Кастомные React-хуки
6. **Utils (utils/)** - Вспомогательные функции
7. **Types (types/)** - TypeScript типы и интерфейсы

## Модель данных

Основные сущности:

1. **Organization** - Организация/Локация
2. **Division** - Отдел/Подразделение
3. **Position** - Должность
4. **Staff** - Сотрудник
5. **FunctionalRelation** - Функциональная связь между сотрудниками

Ключевые отношения:

- Организация содержит Отделы (один ко многим)
- Отделы образуют иерархию (самоссылающееся отношение)
- Сотрудник принадлежит Отделу и имеет Должность
- Функциональные связи создаются между Сотрудниками и имеют определенный Тип связи

## Ключевые бизнес-процессы

1. **Управление организационной структурой**
   - Создание/редактирование организаций и отделов
   - Отображение иерархии в виде дерева

2. **Управление сотрудниками**
   - Добавление/редактирование/удаление сотрудников
   - Привязка к отделам и должностям
   - Загрузка документов и фотографий

3. **Управление функциональными связями**
   - Создание связей разных типов между сотрудниками
   - Визуализация матричной структуры

4. **Интеграция с внешними системами**
   - Импорт/экспорт данных (Excel)
   - Интеграция с Telegram для регистрации

## Безопасность

Система использует следующие механизмы безопасности:

- Аутентификация на основе JWT-токенов
- Авторизация на основе ролей
- Хэширование паролей с использованием bcrypt
- Проверка валидации данных на стороне бэкенда и фронтенда
- CORS-защита
- Защита от SQL-инъекций через ORM

## Масштабируемость

Архитектура системы позволяет горизонтальное масштабирование:

- Бэкенд на FastAPI асинхронный и может обрабатывать множество запросов
- База данных может быть кластеризована
- Фронтенд может быть размещен на CDN
- Возможность использования контейнеризации и оркестрации (Docker, Kubernetes)

## Известные проблемы и ограничения

1. Текущие ограничения визуализации при большом количестве узлов (>100)
2. Отсутствие мобильной версии для некоторых сложных интерфейсов
3. Ограничения при работе с файлами большого размера

## Планы по развитию

1. Добавление аналитических дашбордов
2. Интеграция с системами учета рабочего времени
3. Расширение интеграционных возможностей (API для сторонних систем)
4. Модуль отчетности и статистики 